import"../../../modulepreload-polyfill-B5Qt9EMX.js";import{S as I,a as n,c as i,b as S,p as e,g as v,f as b,v as d,e as O,u as B,d as u,W as q}from"../../../builtins-C5GxhwDd.js";import{W as z,a as R}from"../../../frame-comparison-CBkPASci.js";import{t as j}from"../../../texture-D0-A-o9X.js";import{r as U}from"../../../return-DhHkPme9.js";class H extends I{getGLSLSamplerType(){return"sampler2D"}getWGSLTextureType(){return"texture_depth_2d"}isDepthTexture(){return!0}}function k(t){return new H(t)}const J=n("position",i()),a=S("main",()=>{e("highp","float"),e("highp","int"),v.assign(J)}),w=b("main",()=>{e("highp","float"),e("highp","int")}),K=n("position",d()),N=n("textureCoordinates",d()),L=O("v_st",d()),o=S("main",()=>{e("highp","float"),e("highp","int"),L.assign(N),v.assign(i(K,0,1))}),Q=k(B("depthMap")),x=b("main",()=>{e("highp","float"),e("highp","int");const t=u(j(Q,L).r);U(i(u(1).subtract(t),1))});function f(t){const r=window.devicePixelRatio||1;t.width=t.clientWidth*r,t.height=t.clientHeight*r}document.addEventListener("DOMContentLoaded",async()=>{const t=a.toGLSL(2),r=w.toGLSL(2),y=a.toWGSL({convertDepth:!0}),G=w.toWGSL(a),P=o.toGLSL(2),W=x.toGLSL(2),_=o.toWGSL(),F=x.toWGSL(o),s=document.getElementById("webgpu");f(s);const c=await new z({canvasId:"webgpu"}).init(),p=document.getElementById("webgl");f(p);const l=new q({canvasId:"webgl",webGLcontextId:"webgl2"}),g={x:s.width,y:s.height},V={vertex:{glsl:t,wgsl:y},fragment:{glsl:r,wgsl:G},depthStencil:{},primitive:{topology:"triangle-list"}},C={vertex:{glsl:P,wgsl:_},fragment:{glsl:W,wgsl:F},primitive:{topology:"triangle-list"}},A=new Float32Array([-.5,-.5,-1,1,.5,-.5,-1,1,0,.5,1,1]),D=new Float32Array([-1,-1,1,-1,1,1,1,1,-1,1,-1,-1]),M=new Float32Array([0,0,1,0,1,1,1,1,0,1,0,0]),T={position:{data:A,format:"float32x4"}},E={position:{data:D,format:"float32x2"},textureCoordinates:{data:M,format:"float32x2"}},m={descriptor:{size:[g.x,g.y],format:"depth16unorm"}},h={commandEncoders:[{passEncoders:[{descriptor:{colorAttachments:[],depthStencilAttachment:{view:{texture:m,baseMipLevel:0},depthLoadOp:"clear"}},renderPassObjects:[{pipeline:V,vertices:T,draw:{__type__:"DrawVertex",vertexCount:3}}]},{descriptor:{colorAttachments:[{clearValue:[0,0,0,1],loadOp:"clear"}]},renderPassObjects:[{pipeline:C,bindingResources:{depthMap:{texture:m,sampler:{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",minFilter:"nearest",magFilter:"nearest"}}},vertices:E,draw:{__type__:"DrawVertex",vertexCount:6}}]}]}]};l.submit(h),c.submit(h),R(l,c,p,s,0)});
