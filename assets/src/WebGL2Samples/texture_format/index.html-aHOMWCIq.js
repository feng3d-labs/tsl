import"../../../modulepreload-polyfill-B5Qt9EMX.js";import{a as C,v as f,u as b,e as E,b as O,p as i,g as j,c as p,q as S,f as _,B as T,A as q,W as H}from"../../../builtins-C5GxhwDd.js";import{W as Y,a as k}from"../../../frame-comparison-CBkPASci.js";import{l as g}from"../../../let-Czo32qSi.js";import{s as J}from"../../../sampler2D-DSRZ_QT6.js";import{t as K}from"../../../texelFetch-Bo1BpNhZ.js";import{t as Q}from"../../../texture-D0-A-o9X.js";import{t as Z}from"../../../textureSize-DF-iDVy_.js";import{m as $}from"../../../mat4-Pkjqt0vg.js";import"../../../wgslKeywords-TYZDccpG.js";const tt=C("position",f(),0),et=C("texcoord",f(),4),ot=b("MVP",$()),v=E("v_st",f()),d=O("main",()=>{i("highp","float"),i("highp","int"),v.assign(et),j.assign(ot.multiply(p(tt,0,1)))}),rt=J(b("diffuse")),st=p(S(0,"color")),M=_("main",()=>{i("highp","float"),i("highp","int"),st.assign(Q(rt,v))}),L=T(b("diffuse")),at=p(S(0,"color")),I=_("main",()=>{i("highp","float"),i("highp","int"),i("highp","usampler2D");const r=g("size",Z(L,0)),s=g("texcoord",v.multiply(f(r))),n=g("coord",q(s)),u=g("texel",K(L,n,0));at.assign(p(u).divide(255))});function nt(r,s){const n=new Image;return n.onload=function(){s(n)},n.src=r,n}function U(r){const s=window.devicePixelRatio||1;r.width=r.clientWidth*s,r.height=r.clientHeight*s}const z={MAX:9},e={RGB:0,RGB8:1,RGBA:2,RGB16F:3,RGBA32F:4,R16F:5,RG16F:6,RGB8UI:7,RGBA8UI:8,MAX:9};document.addEventListener("DOMContentLoaded",async()=>{const r=d.toGLSL(2),s=d.toWGSL(),n=M.toGLSL(2),u=M.toWGSL(d),W=I.toGLSL(2),P=I.toWGSL(d),G=document.getElementById("webgpu");U(G);const A=await new Y({canvasId:"webgpu"}).init(),c=document.getElementById("webgl");U(c);const R=new H({canvasId:"webgl",webGLcontextId:"webgl2"}),m={x:c.width,y:c.height},w=new Array(z.MAX);for(let a=0;a<z.MAX;++a){const o=Math.floor(a/3),l=a%3;w[a]={x:m.x*l/3,y:m.y*o/3,width:m.x/3,height:m.y/3}}const X=new Float32Array([-1,-1,1,-1,1,1,1,1,-1,1,-1,-1]),V=new Float32Array([0,1,1,1,1,0,1,0,0,0,0,1]),y={position:{data:X,format:"float32x2"},texcoord:{data:V,format:"float32x2"}};nt("./images/Di-3d.png",a=>{const o=new Array(e.MAX);o[e.RGB]={format:"rgba8unorm"},o[e.RGB8]={format:"rgba8unorm"},o[e.RGBA]={format:"rgba8unorm"},o[e.RGB16F]={format:"rgba16float"},o[e.RGBA32F]={format:"rgba32float"},o[e.R16F]={format:"r16float"},o[e.RG16F]={format:"rg16float"},o[e.RGB8UI]={format:"rgba8uint"},o[e.RGBA8UI]={format:"rgba8uint"};const l=new Array(e.MAX),x=new Array(e.MAX);for(let t=0;t<e.MAX;++t)l[t]={descriptor:{size:[a.width,a.height],format:o[t].format},sources:[{mipLevel:0,image:a,flipY:!1}]},x[t]={minFilter:"nearest",magFilter:"nearest",lodMinClamp:0,lodMaxClamp:0};const B=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),D={vertex:{glsl:r,wgsl:s},fragment:{glsl:n,wgsl:u,targets:[{blend:{}}]},primitive:{topology:"triangle-list"}},N={vertex:{glsl:r,wgsl:s},fragment:{glsl:W,wgsl:P,targets:[{blend:{}}]},primitive:{topology:"triangle-list"}},h=[];for(let t=0;t<e.RGB8UI;++t)h.push({pipeline:D,vertices:y,viewport:w[t],bindingResources:{MVP:{value:B},diffuse:{texture:l[t],sampler:x[t]}},draw:{__type__:"DrawVertex",vertexCount:6,instanceCount:1}});for(let t=e.RGB8UI;t<e.MAX;++t)h.push({pipeline:N,vertices:y,viewport:w[t],bindingResources:{MVP:{value:B},diffuse:{texture:l[t],sampler:x[t]}},draw:{__type__:"DrawVertex",vertexCount:6,instanceCount:1}});const F={commandEncoders:[{passEncoders:[{descriptor:{colorAttachments:[{clearValue:[0,0,0,1],loadOp:"clear"}]},renderPassObjects:h}]}]};R.submit(F),A.submit(F),k(R,A,c,G,2)})});
