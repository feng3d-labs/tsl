import"../../../modulepreload-polyfill-B5Qt9EMX.js";import{a as G,v as T,u as x,e as W,b as S,p as u,g as z,c as I,h as D,q as Y,f as X,W as j}from"../../../builtins-C5GxhwDd.js";import{W as q,a as V}from"../../../frame-comparison-CBkPASci.js";import{s as U}from"../../../sampler2D-DSRZ_QT6.js";import{t as k}from"../../../texture-D0-A-o9X.js";import{m as J}from"../../../mat4-Pkjqt0vg.js";const K=G("position",T(),0),N=G("textureCoordinates",T(),4),Q=x("mvp",J()),B=W("v_st",T()),f=S("main",()=>{u("highp","float"),u("highp","int"),B.assign(N),z.assign(Q.multiply(I(K,0,1)))}),Z=U(x("diffuse")),$=x("lodBias",D()),ee=I(Y(0,"color")),L=X("main",()=>{u("highp","float"),u("highp","int"),ee.assign(k(Z,B,$))});function te(i,a){const n=new Image;return n.onload=function(){a(n)},n.src=i,n}function C(i){const a=window.devicePixelRatio||1;i.width=i.clientWidth*a,i.height=i.clientHeight*a}const t={TOP_LEFT:0,TOP_RIGHT:1,BOTTOM_RIGHT:2,BOTTOM_LEFT:3,MAX:4};document.addEventListener("DOMContentLoaded",async()=>{const i=f.toGLSL(2),a=L.toGLSL(2),n=f.toWGSL({convertDepth:!0}),E=L.toWGSL(f),v=document.getElementById("webgpu");C(v);const O=await new q({canvasId:"webgpu"}).init(),c=document.getElementById("webgl");C(c);const F=new j({canvasId:"webgl",webGLcontextId:"webgl2"});let p=1,g=!1,h=0;window.onmousedown=function(e){g=!0,h=e.clientY},window.onmouseup=function(){g=!1},window.onmousemove=function(e){if(!g)return;const d=e.clientY,w=d-h;p+=w/100,h=d};const o={x:c.width,y:c.height},s=new Array(t.MAX);s[t.BOTTOM_LEFT]={x:0,y:0,width:o.x/2,height:o.y/2},s[t.BOTTOM_RIGHT]={x:o.x/2,y:0,width:o.x/2,height:o.y/2},s[t.TOP_RIGHT]={x:o.x/2,y:o.y/2,width:o.x/2,height:o.y/2},s[t.TOP_LEFT]={x:0,y:o.y/2,width:o.x/2,height:o.y/2};const P=new Float32Array([-1,-1,1,-1,1,1,1,1,-1,1,-1,-1]),R=new Float32Array([0,1,1,1,1,0,1,0,0,0,0,1]),A={position:{data:P,format:"float32x2"},textureCoordinates:{data:R,format:"float32x2"}},l=[],m=[];te("./images/Di-3d.png",e=>{m[t.TOP_LEFT]={descriptor:{size:[e.width,e.height],format:"rgba8unorm",generateMipmap:!0},sources:[{image:e,mipLevel:0}]},l[t.TOP_LEFT]={minFilter:"linear",magFilter:"linear",mipmapFilter:"linear"},m[t.TOP_RIGHT]={descriptor:{size:[e.width,e.height],format:"rgba8unorm",generateMipmap:!0},sources:[{image:e,mipLevel:0}]},l[t.TOP_RIGHT]={minFilter:"linear",magFilter:"linear",mipmapFilter:"linear",lodMinClamp:3,lodMaxClamp:3},m[t.BOTTOM_LEFT]={descriptor:{size:[e.width,e.height],format:"rgba8unorm",generateMipmap:!0},sources:[{image:e,mipLevel:0}]},l[t.BOTTOM_LEFT]={minFilter:"linear",magFilter:"linear",mipmapFilter:"linear",lodMinClamp:0,lodMaxClamp:10},m[t.BOTTOM_RIGHT]={descriptor:{size:[e.width,e.height],format:"rgba8unorm",generateMipmap:!0},sources:[{image:e,mipLevel:0}]},l[t.BOTTOM_RIGHT]={minFilter:"linear",magFilter:"linear",mipmapFilter:"linear",lodMinClamp:0,lodMaxClamp:10};const d={vertex:{glsl:i,wgsl:n},fragment:{glsl:a,wgsl:E,targets:[{blend:{}}]},primitive:{topology:"triangle-list"}},w=[0,0,3.5,4];let b=!1;function y(){const H=new Float32Array([p,0,0,0,0,p,0,0,0,0,p,0,0,0,0,1]),M=[];for(let r=0;r<t.MAX;++r)M.push({pipeline:d,vertices:A,viewport:s[r],bindingResources:{mvp:{value:H},lodBias:{value:w[r]},diffuse:{texture:m[r],sampler:l[r]}},draw:{__type__:"DrawVertex",vertexCount:6,instanceCount:1}});const _={commandEncoders:[{passEncoders:[{descriptor:{colorAttachments:[{clearValue:[0,0,0,1],loadOp:"clear"}]},renderPassObjects:M}]}]};F.submit(_),O.submit(_),b||(b=!0,V(F,O,c,v,0)),requestAnimationFrame(y)}y()})});
