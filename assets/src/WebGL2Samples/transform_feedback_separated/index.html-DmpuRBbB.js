import"../../../modulepreload-polyfill-B5Qt9EMX.js";import{a as f,c as s,u as V,e as T,p as r,g as R,v as W,f as E,b as M,W as N,J as c}from"../../../builtins-C5GxhwDd.js";import{W as D,a as X}from"../../../frame-comparison-CBkPASci.js";import{t as j}from"../../../transform-D6sp5tn9.js";import{r as S}from"../../../return-DhHkPme9.js";import{c as U}from"../../../clamp-DYFz6aCQ.js";import{m as z}from"../../../mat4-Pkjqt0vg.js";const h=f("position",s(),0),H=V("MVP",z()),L=T("v_color",s()),O=j("main",()=>{r("highp","float"),r("highp","int"),R.assign(H.multiply(h)),L.assign(s(U(W(h),0,1),0,1))});E("main",()=>{r("highp","float"),r("highp","int"),S(L)});const J=f("position",s(),0),K=f("color",s(),3),F=T("v_color",s()),l=M("main",()=>{r("highp","float"),r("highp","int"),R.assign(J),F.assign(K)}),x=E("main",()=>{r("highp","float"),r("highp","int"),S(F)});function P(a){const n=window.devicePixelRatio||1;a.width=a.clientWidth*n,a.height=a.clientHeight*n}document.addEventListener("DOMContentLoaded",async()=>{const a=O.toGLSL(),n=O.toWGSL({varyings:["gl_Position","v_color"],bufferMode:"SEPARATE_ATTRIBS"}),k=l.toGLSL(2),y=x.toGLSL(2),A=l.toWGSL(),C=x.toWGSL(l),m=6,G=0,I=1,i=new Float32Array([-1,-1,0,1,1,-1,0,1,1,1,0,1,1,1,0,1,-1,1,0,1,-1,-1,0,1]),e={VERTEX:0,POSITION:1,COLOR:2},t=[i,i.slice(),i.slice()],d=[{vertices:{position:{data:t[e.VERTEX],format:"float32x4"}}},{vertices:{position:{data:t[e.POSITION],format:"float32x4"},color:{data:t[e.COLOR],format:"float32x4"}}}],g={vertex:{glsl:a,wgsl:n},transformFeedbackVaryings:{varyings:["gl_Position","v_color"],bufferMode:"SEPARATE_ATTRIBS"}},b={vertex:{glsl:k,wgsl:A},fragment:{glsl:y,wgsl:C}},p={bindBuffers:[{index:0,data:t[e.POSITION]},{index:1,data:t[e.COLOR]}]},B=new Float32Array([.5,0,0,0,0,.5,0,0,0,0,.5,0,0,0,0,1]),u={commandEncoders:[{passEncoders:[{__type__:"TransformFeedbackPass",transformFeedbackObjects:[{pipeline:g,vertices:d[G].vertices,uniforms:{MVP:{value:B}},transformFeedback:p,draw:{__type__:"DrawVertex",vertexCount:m}}]},{descriptor:{colorAttachments:[{clearValue:[0,0,0,1],loadOp:"clear"}]},renderPassObjects:[{pipeline:b,vertices:d[I].vertices,draw:{__type__:"DrawVertex",vertexCount:m}}]}]}]},v=document.getElementById("webgl");P(v);const o=new N({canvasId:"webgl",webGLcontextId:"webgl2",webGLContextAttributes:{antialias:!1}}),_=document.getElementById("webgpu");P(_);const w=await new D({canvasId:"webgpu"}).init();o.submit(u),w.submit(u),X(o,w,v,_,0),o.deleteTransformFeedback(p),o.deleteBuffer(c.getBuffer(t[e.VERTEX].buffer)),o.deleteBuffer(c.getBuffer(t[e.POSITION].buffer)),o.deleteBuffer(c.getBuffer(t[e.COLOR].buffer)),o.deleteProgram(g),o.deleteProgram(b)});
