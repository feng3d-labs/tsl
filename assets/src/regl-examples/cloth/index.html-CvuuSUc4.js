import"../../../modulepreload-polyfill-B5Qt9EMX.js";import{a as Sn,d as sn,v as Un,u as En,e as Nn,b as As,p as Gn,g as Ss,c as Bn,f as Es,h as Ps,aa as Fs,W as ks,r as rn,J as In}from"../../../builtins-C5GxhwDd.js";import{W as Ts,a as Ds}from"../../../frame-comparison-CBkPASci.js";import{v as u}from"../../../var-BrV_KNjZ.js";import{s as js}from"../../../sampler2D-DSRZ_QT6.js";import{t as Os}from"../../../texture2D-DxhDwbSP.js";import{i as Rs}from"../../../if_-brTBmB0z.js";import{r as Is}from"../../../return-DhHkPme9.js";import{d as Cs}from"../../../dot-di-r-mUL.js";import{n as Vs}from"../../../normalize-BhFzRmv8.js";import{c as Xs}from"../../../clamp-DYFz6aCQ.js";import{m as Zn}from"../../../mat4-Pkjqt0vg.js";import"../../../wgslKeywords-TYZDccpG.js";const A=1e-6;let D=typeof Float32Array<"u"?Float32Array:Array;const on=Math.random;function Qn(){const n=new D(9);return D!==Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n}function Ys(n,s){return n[0]=s[0],n[1]=s[1],n[2]=s[2],n[3]=s[4],n[4]=s[5],n[5]=s[6],n[6]=s[8],n[7]=s[9],n[8]=s[10],n}function Ws(n){const s=new D(9);return s[0]=n[0],s[1]=n[1],s[2]=n[2],s[3]=n[3],s[4]=n[4],s[5]=n[5],s[6]=n[6],s[7]=n[7],s[8]=n[8],s}function Us(n,s){return n[0]=s[0],n[1]=s[1],n[2]=s[2],n[3]=s[3],n[4]=s[4],n[5]=s[5],n[6]=s[6],n[7]=s[7],n[8]=s[8],n}function Ns(n,s,t,e,c,r,i,o,l){const f=new D(9);return f[0]=n,f[1]=s,f[2]=t,f[3]=e,f[4]=c,f[5]=r,f[6]=i,f[7]=o,f[8]=l,f}function Gs(n,s,t,e,c,r,i,o,l,f){return n[0]=s,n[1]=t,n[2]=e,n[3]=c,n[4]=r,n[5]=i,n[6]=o,n[7]=l,n[8]=f,n}function Bs(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=1,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n}function Zs(n,s){if(n===s){const t=s[1],e=s[2],c=s[5];n[1]=s[3],n[2]=s[6],n[3]=t,n[5]=s[7],n[6]=e,n[7]=c}else n[0]=s[0],n[1]=s[3],n[2]=s[6],n[3]=s[1],n[4]=s[4],n[5]=s[7],n[6]=s[2],n[7]=s[5],n[8]=s[8];return n}function Qs(n,s){const t=s[0],e=s[1],c=s[2],r=s[3],i=s[4],o=s[5],l=s[6],f=s[7],h=s[8],d=h*i-o*f,a=-h*r+o*l,M=f*r-i*l;let p=t*d+e*a+c*M;return p?(p=1/p,n[0]=d*p,n[1]=(-h*e+c*f)*p,n[2]=(o*e-c*i)*p,n[3]=a*p,n[4]=(h*t-c*l)*p,n[5]=(-o*t+c*r)*p,n[6]=M*p,n[7]=(-f*t+e*l)*p,n[8]=(i*t-e*r)*p,n):null}function Hs(n,s){const t=s[0],e=s[1],c=s[2],r=s[3],i=s[4],o=s[5],l=s[6],f=s[7],h=s[8];return n[0]=i*h-o*f,n[1]=c*f-e*h,n[2]=e*o-c*i,n[3]=o*l-r*h,n[4]=t*h-c*l,n[5]=c*r-t*o,n[6]=r*f-i*l,n[7]=e*l-t*f,n[8]=t*i-e*r,n}function Js(n){const s=n[0],t=n[1],e=n[2],c=n[3],r=n[4],i=n[5],o=n[6],l=n[7],f=n[8];return s*(f*r-i*l)+t*(-f*c+i*o)+e*(l*c-r*o)}function Hn(n,s,t){const e=s[0],c=s[1],r=s[2],i=s[3],o=s[4],l=s[5],f=s[6],h=s[7],d=s[8],a=t[0],M=t[1],p=t[2],w=t[3],m=t[4],y=t[5],_=t[6],g=t[7],$=t[8];return n[0]=a*e+M*i+p*f,n[1]=a*c+M*o+p*h,n[2]=a*r+M*l+p*d,n[3]=w*e+m*i+y*f,n[4]=w*c+m*o+y*h,n[5]=w*r+m*l+y*d,n[6]=_*e+g*i+$*f,n[7]=_*c+g*o+$*h,n[8]=_*r+g*l+$*d,n}function Ks(n,s,t){const e=s[0],c=s[1],r=s[2],i=s[3],o=s[4],l=s[5],f=s[6],h=s[7],d=s[8],a=t[0],M=t[1];return n[0]=e,n[1]=c,n[2]=r,n[3]=i,n[4]=o,n[5]=l,n[6]=a*e+M*i+f,n[7]=a*c+M*o+h,n[8]=a*r+M*l+d,n}function us(n,s,t){const e=s[0],c=s[1],r=s[2],i=s[3],o=s[4],l=s[5],f=s[6],h=s[7],d=s[8],a=Math.sin(t),M=Math.cos(t);return n[0]=M*e+a*i,n[1]=M*c+a*o,n[2]=M*r+a*l,n[3]=M*i-a*e,n[4]=M*o-a*c,n[5]=M*l-a*r,n[6]=f,n[7]=h,n[8]=d,n}function nt(n,s,t){const e=t[0],c=t[1];return n[0]=e*s[0],n[1]=e*s[1],n[2]=e*s[2],n[3]=c*s[3],n[4]=c*s[4],n[5]=c*s[5],n[6]=s[6],n[7]=s[7],n[8]=s[8],n}function st(n,s){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=1,n[5]=0,n[6]=s[0],n[7]=s[1],n[8]=1,n}function tt(n,s){const t=Math.sin(s),e=Math.cos(s);return n[0]=e,n[1]=t,n[2]=0,n[3]=-t,n[4]=e,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n}function et(n,s){return n[0]=s[0],n[1]=0,n[2]=0,n[3]=0,n[4]=s[1],n[5]=0,n[6]=0,n[7]=0,n[8]=1,n}function ct(n,s){return n[0]=s[0],n[1]=s[1],n[2]=0,n[3]=s[2],n[4]=s[3],n[5]=0,n[6]=s[4],n[7]=s[5],n[8]=1,n}function rt(n,s){const t=s[0],e=s[1],c=s[2],r=s[3],i=t+t,o=e+e,l=c+c,f=t*i,h=e*i,d=e*o,a=c*i,M=c*o,p=c*l,w=r*i,m=r*o,y=r*l;return n[0]=1-d-p,n[3]=h-y,n[6]=a+m,n[1]=h+y,n[4]=1-f-p,n[7]=M-w,n[2]=a-m,n[5]=M+w,n[8]=1-f-d,n}function it(n,s){const t=s[0],e=s[1],c=s[2],r=s[3],i=s[4],o=s[5],l=s[6],f=s[7],h=s[8],d=s[9],a=s[10],M=s[11],p=s[12],w=s[13],m=s[14],y=s[15],_=t*o-e*i,g=t*l-c*i,$=t*f-r*i,z=e*l-c*o,v=e*f-r*o,q=c*f-r*l,L=h*w-d*p,x=h*m-a*p,S=h*y-M*p,P=d*m-a*w,E=d*y-M*w,F=a*y-M*m;let b=_*F-g*E+$*P+z*S-v*x+q*L;return b?(b=1/b,n[0]=(o*F-l*E+f*P)*b,n[1]=(l*S-i*F-f*x)*b,n[2]=(i*E-o*S+f*L)*b,n[3]=(c*E-e*F-r*P)*b,n[4]=(t*F-c*S+r*x)*b,n[5]=(e*S-t*E-r*L)*b,n[6]=(w*q-m*v+y*z)*b,n[7]=(m*$-p*q-y*g)*b,n[8]=(p*v-w*$+y*_)*b,n):null}function ot(n,s,t){return n[0]=2/s,n[1]=0,n[2]=0,n[3]=0,n[4]=-2/t,n[5]=0,n[6]=-1,n[7]=1,n[8]=1,n}function lt(n){return`mat3(${n[0]}, ${n[1]}, ${n[2]}, ${n[3]}, ${n[4]}, ${n[5]}, ${n[6]}, ${n[7]}, ${n[8]})`}function ft(n){return Math.sqrt(Math.pow(n[0],2)+Math.pow(n[1],2)+Math.pow(n[2],2)+Math.pow(n[3],2)+Math.pow(n[4],2)+Math.pow(n[5],2)+Math.pow(n[6],2)+Math.pow(n[7],2)+Math.pow(n[8],2))}function ht(n,s,t){return n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2],n[3]=s[3]+t[3],n[4]=s[4]+t[4],n[5]=s[5]+t[5],n[6]=s[6]+t[6],n[7]=s[7]+t[7],n[8]=s[8]+t[8],n}function Jn(n,s,t){return n[0]=s[0]-t[0],n[1]=s[1]-t[1],n[2]=s[2]-t[2],n[3]=s[3]-t[3],n[4]=s[4]-t[4],n[5]=s[5]-t[5],n[6]=s[6]-t[6],n[7]=s[7]-t[7],n[8]=s[8]-t[8],n}function at(n,s,t){return n[0]=s[0]*t,n[1]=s[1]*t,n[2]=s[2]*t,n[3]=s[3]*t,n[4]=s[4]*t,n[5]=s[5]*t,n[6]=s[6]*t,n[7]=s[7]*t,n[8]=s[8]*t,n}function Mt(n,s,t,e){return n[0]=s[0]+t[0]*e,n[1]=s[1]+t[1]*e,n[2]=s[2]+t[2]*e,n[3]=s[3]+t[3]*e,n[4]=s[4]+t[4]*e,n[5]=s[5]+t[5]*e,n[6]=s[6]+t[6]*e,n[7]=s[7]+t[7]*e,n[8]=s[8]+t[8]*e,n}function dt(n,s){return n[0]===s[0]&&n[1]===s[1]&&n[2]===s[2]&&n[3]===s[3]&&n[4]===s[4]&&n[5]===s[5]&&n[6]===s[6]&&n[7]===s[7]&&n[8]===s[8]}function mt(n,s){const t=n[0],e=n[1],c=n[2],r=n[3],i=n[4],o=n[5],l=n[6],f=n[7],h=n[8],d=s[0],a=s[1],M=s[2],p=s[3],w=s[4],m=s[5],y=s[6],_=s[7],g=s[8];return Math.abs(t-d)<=A*Math.max(1,Math.abs(t),Math.abs(d))&&Math.abs(e-a)<=A*Math.max(1,Math.abs(e),Math.abs(a))&&Math.abs(c-M)<=A*Math.max(1,Math.abs(c),Math.abs(M))&&Math.abs(r-p)<=A*Math.max(1,Math.abs(r),Math.abs(p))&&Math.abs(i-w)<=A*Math.max(1,Math.abs(i),Math.abs(w))&&Math.abs(o-m)<=A*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(l-y)<=A*Math.max(1,Math.abs(l),Math.abs(y))&&Math.abs(f-_)<=A*Math.max(1,Math.abs(f),Math.abs(_))&&Math.abs(h-g)<=A*Math.max(1,Math.abs(h),Math.abs(g))}const pt=Hn,wt=Jn,yt=Object.freeze(Object.defineProperty({__proto__:null,add:ht,adjoint:Hs,clone:Ws,copy:Us,create:Qn,determinant:Js,equals:mt,exactEquals:dt,frob:ft,fromMat2d:ct,fromMat4:Ys,fromQuat:rt,fromRotation:tt,fromScaling:et,fromTranslation:st,fromValues:Ns,identity:Bs,invert:Qs,mul:pt,multiply:Hn,multiplyScalar:at,multiplyScalarAndAdd:Mt,normalFromMat4:it,projection:ot,rotate:us,scale:nt,set:Gs,str:lt,sub:wt,subtract:Jn,translate:Ks,transpose:Zs},Symbol.toStringTag,{value:"Module"}));function xt(){const n=new D(16);return D!==Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n}function vt(n){const s=new D(16);return s[0]=n[0],s[1]=n[1],s[2]=n[2],s[3]=n[3],s[4]=n[4],s[5]=n[5],s[6]=n[6],s[7]=n[7],s[8]=n[8],s[9]=n[9],s[10]=n[10],s[11]=n[11],s[12]=n[12],s[13]=n[13],s[14]=n[14],s[15]=n[15],s}function gt(n,s){return n[0]=s[0],n[1]=s[1],n[2]=s[2],n[3]=s[3],n[4]=s[4],n[5]=s[5],n[6]=s[6],n[7]=s[7],n[8]=s[8],n[9]=s[9],n[10]=s[10],n[11]=s[11],n[12]=s[12],n[13]=s[13],n[14]=s[14],n[15]=s[15],n}function $t(n,s,t,e,c,r,i,o,l,f,h,d,a,M,p,w){const m=new D(16);return m[0]=n,m[1]=s,m[2]=t,m[3]=e,m[4]=c,m[5]=r,m[6]=i,m[7]=o,m[8]=l,m[9]=f,m[10]=h,m[11]=d,m[12]=a,m[13]=M,m[14]=p,m[15]=w,m}function zt(n,s,t,e,c,r,i,o,l,f,h,d,a,M,p,w,m){return n[0]=s,n[1]=t,n[2]=e,n[3]=c,n[4]=r,n[5]=i,n[6]=o,n[7]=l,n[8]=f,n[9]=h,n[10]=d,n[11]=a,n[12]=M,n[13]=p,n[14]=w,n[15]=m,n}function Kn(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function _t(n,s){if(n===s){const t=s[1],e=s[2],c=s[3],r=s[6],i=s[7],o=s[11];n[1]=s[4],n[2]=s[8],n[3]=s[12],n[4]=t,n[6]=s[9],n[7]=s[13],n[8]=e,n[9]=r,n[11]=s[14],n[12]=c,n[13]=i,n[14]=o}else n[0]=s[0],n[1]=s[4],n[2]=s[8],n[3]=s[12],n[4]=s[1],n[5]=s[5],n[6]=s[9],n[7]=s[13],n[8]=s[2],n[9]=s[6],n[10]=s[10],n[11]=s[14],n[12]=s[3],n[13]=s[7],n[14]=s[11],n[15]=s[15];return n}function bt(n,s){const t=s[0],e=s[1],c=s[2],r=s[3],i=s[4],o=s[5],l=s[6],f=s[7],h=s[8],d=s[9],a=s[10],M=s[11],p=s[12],w=s[13],m=s[14],y=s[15],_=t*o-e*i,g=t*l-c*i,$=t*f-r*i,z=e*l-c*o,v=e*f-r*o,q=c*f-r*l,L=h*w-d*p,x=h*m-a*p,S=h*y-M*p,P=d*m-a*w,E=d*y-M*w,F=a*y-M*m;let b=_*F-g*E+$*P+z*S-v*x+q*L;return b?(b=1/b,n[0]=(o*F-l*E+f*P)*b,n[1]=(c*E-e*F-r*P)*b,n[2]=(w*q-m*v+y*z)*b,n[3]=(a*v-d*q-M*z)*b,n[4]=(l*S-i*F-f*x)*b,n[5]=(t*F-c*S+r*x)*b,n[6]=(m*$-p*q-y*g)*b,n[7]=(h*q-a*$+M*g)*b,n[8]=(i*E-o*S+f*L)*b,n[9]=(e*S-t*E-r*L)*b,n[10]=(p*v-w*$+y*_)*b,n[11]=(d*$-h*v-M*_)*b,n[12]=(o*x-i*P-l*L)*b,n[13]=(t*P-e*x+c*L)*b,n[14]=(w*g-p*z-m*_)*b,n[15]=(h*z-d*g+a*_)*b,n):null}function Lt(n,s){const t=s[0],e=s[1],c=s[2],r=s[3],i=s[4],o=s[5],l=s[6],f=s[7],h=s[8],d=s[9],a=s[10],M=s[11],p=s[12],w=s[13],m=s[14],y=s[15];return n[0]=o*(a*y-M*m)-d*(l*y-f*m)+w*(l*M-f*a),n[1]=-(e*(a*y-M*m)-d*(c*y-r*m)+w*(c*M-r*a)),n[2]=e*(l*y-f*m)-o*(c*y-r*m)+w*(c*f-r*l),n[3]=-(e*(l*M-f*a)-o*(c*M-r*a)+d*(c*f-r*l)),n[4]=-(i*(a*y-M*m)-h*(l*y-f*m)+p*(l*M-f*a)),n[5]=t*(a*y-M*m)-h*(c*y-r*m)+p*(c*M-r*a),n[6]=-(t*(l*y-f*m)-i*(c*y-r*m)+p*(c*f-r*l)),n[7]=t*(l*M-f*a)-i*(c*M-r*a)+h*(c*f-r*l),n[8]=i*(d*y-M*w)-h*(o*y-f*w)+p*(o*M-f*d),n[9]=-(t*(d*y-M*w)-h*(e*y-r*w)+p*(e*M-r*d)),n[10]=t*(o*y-f*w)-i*(e*y-r*w)+p*(e*f-r*o),n[11]=-(t*(o*M-f*d)-i*(e*M-r*d)+h*(e*f-r*o)),n[12]=-(i*(d*m-a*w)-h*(o*m-l*w)+p*(o*a-l*d)),n[13]=t*(d*m-a*w)-h*(e*m-c*w)+p*(e*a-c*d),n[14]=-(t*(o*m-l*w)-i*(e*m-c*w)+p*(e*l-c*o)),n[15]=t*(o*a-l*d)-i*(e*a-c*d)+h*(e*l-c*o),n}function qt(n){const s=n[0],t=n[1],e=n[2],c=n[3],r=n[4],i=n[5],o=n[6],l=n[7],f=n[8],h=n[9],d=n[10],a=n[11],M=n[12],p=n[13],w=n[14],m=n[15],y=s*i-t*r,_=s*o-e*r,g=s*l-c*r,$=t*o-e*i,z=t*l-c*i,v=e*l-c*o,q=f*p-h*M,L=f*w-d*M,x=f*m-a*M,S=h*w-d*p,P=h*m-a*p,E=d*m-a*w;return y*E-_*P+g*S+$*x-z*L+v*q}function un(n,s,t){const e=s[0],c=s[1],r=s[2],i=s[3],o=s[4],l=s[5],f=s[6],h=s[7],d=s[8],a=s[9],M=s[10],p=s[11],w=s[12],m=s[13],y=s[14],_=s[15];let g=t[0],$=t[1],z=t[2],v=t[3];return n[0]=g*e+$*o+z*d+v*w,n[1]=g*c+$*l+z*a+v*m,n[2]=g*r+$*f+z*M+v*y,n[3]=g*i+$*h+z*p+v*_,g=t[4],$=t[5],z=t[6],v=t[7],n[4]=g*e+$*o+z*d+v*w,n[5]=g*c+$*l+z*a+v*m,n[6]=g*r+$*f+z*M+v*y,n[7]=g*i+$*h+z*p+v*_,g=t[8],$=t[9],z=t[10],v=t[11],n[8]=g*e+$*o+z*d+v*w,n[9]=g*c+$*l+z*a+v*m,n[10]=g*r+$*f+z*M+v*y,n[11]=g*i+$*h+z*p+v*_,g=t[12],$=t[13],z=t[14],v=t[15],n[12]=g*e+$*o+z*d+v*w,n[13]=g*c+$*l+z*a+v*m,n[14]=g*r+$*f+z*M+v*y,n[15]=g*i+$*h+z*p+v*_,n}function At(n,s,t){const e=t[0],c=t[1],r=t[2];let i,o,l,f,h,d,a,M,p,w,m,y;return s===n?(n[12]=s[0]*e+s[4]*c+s[8]*r+s[12],n[13]=s[1]*e+s[5]*c+s[9]*r+s[13],n[14]=s[2]*e+s[6]*c+s[10]*r+s[14],n[15]=s[3]*e+s[7]*c+s[11]*r+s[15]):(i=s[0],o=s[1],l=s[2],f=s[3],h=s[4],d=s[5],a=s[6],M=s[7],p=s[8],w=s[9],m=s[10],y=s[11],n[0]=i,n[1]=o,n[2]=l,n[3]=f,n[4]=h,n[5]=d,n[6]=a,n[7]=M,n[8]=p,n[9]=w,n[10]=m,n[11]=y,n[12]=i*e+h*c+p*r+s[12],n[13]=o*e+d*c+w*r+s[13],n[14]=l*e+a*c+m*r+s[14],n[15]=f*e+M*c+y*r+s[15]),n}function St(n,s,t){const e=t[0],c=t[1],r=t[2];return n[0]=s[0]*e,n[1]=s[1]*e,n[2]=s[2]*e,n[3]=s[3]*e,n[4]=s[4]*c,n[5]=s[5]*c,n[6]=s[6]*c,n[7]=s[7]*c,n[8]=s[8]*r,n[9]=s[9]*r,n[10]=s[10]*r,n[11]=s[11]*r,n[12]=s[12],n[13]=s[13],n[14]=s[14],n[15]=s[15],n}function Et(n,s,t,e){let c=e[0],r=e[1],i=e[2],o=Math.sqrt(c*c+r*r+i*i);if(o<A)return null;o=1/o,c*=o,r*=o,i*=o;const l=Math.sin(t),f=Math.cos(t),h=1-f,d=s[0],a=s[1],M=s[2],p=s[3],w=s[4],m=s[5],y=s[6],_=s[7],g=s[8],$=s[9],z=s[10],v=s[11],q=c*c*h+f,L=r*c*h+i*l,x=i*c*h-r*l,S=c*r*h-i*l,P=r*r*h+f,E=i*r*h+c*l,F=c*i*h+r*l,b=r*i*h-c*l,C=i*i*h+f;return n[0]=d*q+w*L+g*x,n[1]=a*q+m*L+$*x,n[2]=M*q+y*L+z*x,n[3]=p*q+_*L+v*x,n[4]=d*S+w*P+g*E,n[5]=a*S+m*P+$*E,n[6]=M*S+y*P+z*E,n[7]=p*S+_*P+v*E,n[8]=d*F+w*b+g*C,n[9]=a*F+m*b+$*C,n[10]=M*F+y*b+z*C,n[11]=p*F+_*b+v*C,s!==n&&(n[12]=s[12],n[13]=s[13],n[14]=s[14],n[15]=s[15]),n}function Pt(n,s,t){const e=Math.sin(t),c=Math.cos(t),r=s[4],i=s[5],o=s[6],l=s[7],f=s[8],h=s[9],d=s[10],a=s[11];return s!==n&&(n[0]=s[0],n[1]=s[1],n[2]=s[2],n[3]=s[3],n[12]=s[12],n[13]=s[13],n[14]=s[14],n[15]=s[15]),n[4]=r*c+f*e,n[5]=i*c+h*e,n[6]=o*c+d*e,n[7]=l*c+a*e,n[8]=f*c-r*e,n[9]=h*c-i*e,n[10]=d*c-o*e,n[11]=a*c-l*e,n}function Ft(n,s,t){const e=Math.sin(t),c=Math.cos(t),r=s[0],i=s[1],o=s[2],l=s[3],f=s[8],h=s[9],d=s[10],a=s[11];return s!==n&&(n[4]=s[4],n[5]=s[5],n[6]=s[6],n[7]=s[7],n[12]=s[12],n[13]=s[13],n[14]=s[14],n[15]=s[15]),n[0]=r*c-f*e,n[1]=i*c-h*e,n[2]=o*c-d*e,n[3]=l*c-a*e,n[8]=r*e+f*c,n[9]=i*e+h*c,n[10]=o*e+d*c,n[11]=l*e+a*c,n}function kt(n,s,t){const e=Math.sin(t),c=Math.cos(t),r=s[0],i=s[1],o=s[2],l=s[3],f=s[4],h=s[5],d=s[6],a=s[7];return s!==n&&(n[8]=s[8],n[9]=s[9],n[10]=s[10],n[11]=s[11],n[12]=s[12],n[13]=s[13],n[14]=s[14],n[15]=s[15]),n[0]=r*c+f*e,n[1]=i*c+h*e,n[2]=o*c+d*e,n[3]=l*c+a*e,n[4]=f*c-r*e,n[5]=h*c-i*e,n[6]=d*c-o*e,n[7]=a*c-l*e,n}function Tt(n,s){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=s[0],n[13]=s[1],n[14]=s[2],n[15]=1,n}function Dt(n,s){return n[0]=s[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=s[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=s[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function jt(n,s,t){let e=t[0],c=t[1],r=t[2],i=Math.sqrt(e*e+c*c+r*r);if(i<A)return null;i=1/i,e*=i,c*=i,r*=i;const o=Math.sin(s),l=Math.cos(s),f=1-l;return n[0]=e*e*f+l,n[1]=c*e*f+r*o,n[2]=r*e*f-c*o,n[3]=0,n[4]=e*c*f-r*o,n[5]=c*c*f+l,n[6]=r*c*f+e*o,n[7]=0,n[8]=e*r*f+c*o,n[9]=c*r*f-e*o,n[10]=r*r*f+l,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Ot(n,s){const t=Math.sin(s),e=Math.cos(s);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=e,n[6]=t,n[7]=0,n[8]=0,n[9]=-t,n[10]=e,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Rt(n,s){const t=Math.sin(s),e=Math.cos(s);return n[0]=e,n[1]=0,n[2]=-t,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=t,n[9]=0,n[10]=e,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function It(n,s){const t=Math.sin(s),e=Math.cos(s);return n[0]=e,n[1]=t,n[2]=0,n[3]=0,n[4]=-t,n[5]=e,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function ns(n,s,t){const e=s[0],c=s[1],r=s[2],i=s[3],o=e+e,l=c+c,f=r+r,h=e*o,d=e*l,a=e*f,M=c*l,p=c*f,w=r*f,m=i*o,y=i*l,_=i*f;return n[0]=1-(M+w),n[1]=d+_,n[2]=a-y,n[3]=0,n[4]=d-_,n[5]=1-(h+w),n[6]=p+m,n[7]=0,n[8]=a+y,n[9]=p-m,n[10]=1-(h+M),n[11]=0,n[12]=t[0],n[13]=t[1],n[14]=t[2],n[15]=1,n}function Ct(n,s){const t=new D(3),e=-s[0],c=-s[1],r=-s[2],i=s[3],o=s[4],l=s[5],f=s[6],h=s[7],d=e*e+c*c+r*r+i*i;return d>0?(t[0]=(o*i+h*e+l*r-f*c)*2/d,t[1]=(l*i+h*c+f*e-o*r)*2/d,t[2]=(f*i+h*r+o*c-l*e)*2/d):(t[0]=(o*i+h*e+l*r-f*c)*2,t[1]=(l*i+h*c+f*e-o*r)*2,t[2]=(f*i+h*r+o*c-l*e)*2),ns(n,s,t),n}function Vt(n,s){return n[0]=s[12],n[1]=s[13],n[2]=s[14],n}function Xt(n,s){const t=s[0],e=s[1],c=s[2],r=s[4],i=s[5],o=s[6],l=s[8],f=s[9],h=s[10];return n[0]=Math.sqrt(t*t+e*e+c*c),n[1]=Math.sqrt(r*r+i*i+o*o),n[2]=Math.sqrt(l*l+f*f+h*h),n}function Yt(n,s){const t=s[0]+s[5]+s[10];let e=0;return t>0?(e=Math.sqrt(t+1)*2,n[3]=.25*e,n[0]=(s[6]-s[9])/e,n[1]=(s[8]-s[2])/e,n[2]=(s[1]-s[4])/e):s[0]>s[5]&&s[0]>s[10]?(e=Math.sqrt(1+s[0]-s[5]-s[10])*2,n[3]=(s[6]-s[9])/e,n[0]=.25*e,n[1]=(s[1]+s[4])/e,n[2]=(s[8]+s[2])/e):s[5]>s[10]?(e=Math.sqrt(1+s[5]-s[0]-s[10])*2,n[3]=(s[8]-s[2])/e,n[0]=(s[1]+s[4])/e,n[1]=.25*e,n[2]=(s[6]+s[9])/e):(e=Math.sqrt(1+s[10]-s[0]-s[5])*2,n[3]=(s[1]-s[4])/e,n[0]=(s[8]+s[2])/e,n[1]=(s[6]+s[9])/e,n[2]=.25*e),n}function Wt(n,s,t,e){const c=s[0],r=s[1],i=s[2],o=s[3],l=c+c,f=r+r,h=i+i,d=c*l,a=c*f,M=c*h,p=r*f,w=r*h,m=i*h,y=o*l,_=o*f,g=o*h,$=e[0],z=e[1],v=e[2];return n[0]=(1-(p+m))*$,n[1]=(a+g)*$,n[2]=(M-_)*$,n[3]=0,n[4]=(a-g)*z,n[5]=(1-(d+m))*z,n[6]=(w+y)*z,n[7]=0,n[8]=(M+_)*v,n[9]=(w-y)*v,n[10]=(1-(d+p))*v,n[11]=0,n[12]=t[0],n[13]=t[1],n[14]=t[2],n[15]=1,n}function Ut(n,s,t,e,c){const r=s[0],i=s[1],o=s[2],l=s[3],f=r+r,h=i+i,d=o+o,a=r*f,M=r*h,p=r*d,w=i*h,m=i*d,y=o*d,_=l*f,g=l*h,$=l*d,z=e[0],v=e[1],q=e[2],L=c[0],x=c[1],S=c[2],P=(1-(w+y))*z,E=(M+$)*z,F=(p-g)*z,b=(M-$)*v,C=(1-(a+y))*v,Q=(m+_)*v,N=(p+g)*q,H=(m-_)*q,Mn=(1-(a+w))*q;return n[0]=P,n[1]=E,n[2]=F,n[3]=0,n[4]=b,n[5]=C,n[6]=Q,n[7]=0,n[8]=N,n[9]=H,n[10]=Mn,n[11]=0,n[12]=t[0]+L-(P*L+b*x+N*S),n[13]=t[1]+x-(E*L+C*x+H*S),n[14]=t[2]+S-(F*L+Q*x+Mn*S),n[15]=1,n}function Nt(n,s){const t=s[0],e=s[1],c=s[2],r=s[3],i=t+t,o=e+e,l=c+c,f=t*i,h=e*i,d=e*o,a=c*i,M=c*o,p=c*l,w=r*i,m=r*o,y=r*l;return n[0]=1-d-p,n[1]=h+y,n[2]=a-m,n[3]=0,n[4]=h-y,n[5]=1-f-p,n[6]=M+w,n[7]=0,n[8]=a+m,n[9]=M-w,n[10]=1-f-d,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Gt(n,s,t,e,c,r,i){const o=1/(t-s),l=1/(c-e),f=1/(r-i);return n[0]=r*2*o,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=r*2*l,n[6]=0,n[7]=0,n[8]=(t+s)*o,n[9]=(c+e)*l,n[10]=(i+r)*f,n[11]=-1,n[12]=0,n[13]=0,n[14]=i*r*2*f,n[15]=0,n}function Bt(n,s,t,e,c){const r=1/Math.tan(s/2);let i;return n[0]=r/t,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=r,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,!c&&c!==1/0?(i=1/(e-c),n[10]=(c+e)*i,n[14]=2*c*e*i):(n[10]=-1,n[14]=-2*e),n}function Zt(n,s,t,e){const c=Math.tan(s.upDegrees*Math.PI/180),r=Math.tan(s.downDegrees*Math.PI/180),i=Math.tan(s.leftDegrees*Math.PI/180),o=Math.tan(s.rightDegrees*Math.PI/180),l=2/(i+o),f=2/(c+r);return n[0]=l,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=f,n[6]=0,n[7]=0,n[8]=-((i-o)*l*.5),n[9]=(c-r)*f*.5,n[10]=e/(t-e),n[11]=-1,n[12]=0,n[13]=0,n[14]=e*t/(t-e),n[15]=0,n}function Qt(n,s,t,e,c,r,i){const o=1/(s-t),l=1/(e-c),f=1/(r-i);return n[0]=-2*o,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*l,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*f,n[11]=0,n[12]=(s+t)*o,n[13]=(c+e)*l,n[14]=(i+r)*f,n[15]=1,n}function Ht(n,s,t,e){let c,r,i,o,l,f,h,d,a,M;const p=s[0],w=s[1],m=s[2],y=e[0],_=e[1],g=e[2],$=t[0],z=t[1],v=t[2];return Math.abs(p-$)<A&&Math.abs(w-z)<A&&Math.abs(m-v)<A?Kn(n):(h=p-$,d=w-z,a=m-v,M=1/Math.sqrt(h*h+d*d+a*a),h*=M,d*=M,a*=M,c=_*a-g*d,r=g*h-y*a,i=y*d-_*h,M=Math.sqrt(c*c+r*r+i*i),M?(M=1/M,c*=M,r*=M,i*=M):(c=0,r=0,i=0),o=d*i-a*r,l=a*c-h*i,f=h*r-d*c,M=Math.sqrt(o*o+l*l+f*f),M?(M=1/M,o*=M,l*=M,f*=M):(o=0,l=0,f=0),n[0]=c,n[1]=o,n[2]=h,n[3]=0,n[4]=r,n[5]=l,n[6]=d,n[7]=0,n[8]=i,n[9]=f,n[10]=a,n[11]=0,n[12]=-(c*p+r*w+i*m),n[13]=-(o*p+l*w+f*m),n[14]=-(h*p+d*w+a*m),n[15]=1,n)}function Jt(n,s,t,e){const c=s[0],r=s[1],i=s[2],o=e[0],l=e[1],f=e[2];let h=c-t[0],d=r-t[1],a=i-t[2],M=h*h+d*d+a*a;M>0&&(M=1/Math.sqrt(M),h*=M,d*=M,a*=M);let p=l*a-f*d,w=f*h-o*a,m=o*d-l*h;return M=p*p+w*w+m*m,M>0&&(M=1/Math.sqrt(M),p*=M,w*=M,m*=M),n[0]=p,n[1]=w,n[2]=m,n[3]=0,n[4]=d*m-a*w,n[5]=a*p-h*m,n[6]=h*w-d*p,n[7]=0,n[8]=h,n[9]=d,n[10]=a,n[11]=0,n[12]=c,n[13]=r,n[14]=i,n[15]=1,n}function Kt(n){return`mat4(${n[0]}, ${n[1]}, ${n[2]}, ${n[3]}, ${n[4]}, ${n[5]}, ${n[6]}, ${n[7]}, ${n[8]}, ${n[9]}, ${n[10]}, ${n[11]}, ${n[12]}, ${n[13]}, ${n[14]}, ${n[15]})`}function ut(n){return Math.sqrt(Math.pow(n[0],2)+Math.pow(n[1],2)+Math.pow(n[2],2)+Math.pow(n[3],2)+Math.pow(n[4],2)+Math.pow(n[5],2)+Math.pow(n[6],2)+Math.pow(n[7],2)+Math.pow(n[8],2)+Math.pow(n[9],2)+Math.pow(n[10],2)+Math.pow(n[11],2)+Math.pow(n[12],2)+Math.pow(n[13],2)+Math.pow(n[14],2)+Math.pow(n[15],2))}function ne(n,s,t){return n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2],n[3]=s[3]+t[3],n[4]=s[4]+t[4],n[5]=s[5]+t[5],n[6]=s[6]+t[6],n[7]=s[7]+t[7],n[8]=s[8]+t[8],n[9]=s[9]+t[9],n[10]=s[10]+t[10],n[11]=s[11]+t[11],n[12]=s[12]+t[12],n[13]=s[13]+t[13],n[14]=s[14]+t[14],n[15]=s[15]+t[15],n}function ss(n,s,t){return n[0]=s[0]-t[0],n[1]=s[1]-t[1],n[2]=s[2]-t[2],n[3]=s[3]-t[3],n[4]=s[4]-t[4],n[5]=s[5]-t[5],n[6]=s[6]-t[6],n[7]=s[7]-t[7],n[8]=s[8]-t[8],n[9]=s[9]-t[9],n[10]=s[10]-t[10],n[11]=s[11]-t[11],n[12]=s[12]-t[12],n[13]=s[13]-t[13],n[14]=s[14]-t[14],n[15]=s[15]-t[15],n}function se(n,s,t){return n[0]=s[0]*t,n[1]=s[1]*t,n[2]=s[2]*t,n[3]=s[3]*t,n[4]=s[4]*t,n[5]=s[5]*t,n[6]=s[6]*t,n[7]=s[7]*t,n[8]=s[8]*t,n[9]=s[9]*t,n[10]=s[10]*t,n[11]=s[11]*t,n[12]=s[12]*t,n[13]=s[13]*t,n[14]=s[14]*t,n[15]=s[15]*t,n}function te(n,s,t,e){return n[0]=s[0]+t[0]*e,n[1]=s[1]+t[1]*e,n[2]=s[2]+t[2]*e,n[3]=s[3]+t[3]*e,n[4]=s[4]+t[4]*e,n[5]=s[5]+t[5]*e,n[6]=s[6]+t[6]*e,n[7]=s[7]+t[7]*e,n[8]=s[8]+t[8]*e,n[9]=s[9]+t[9]*e,n[10]=s[10]+t[10]*e,n[11]=s[11]+t[11]*e,n[12]=s[12]+t[12]*e,n[13]=s[13]+t[13]*e,n[14]=s[14]+t[14]*e,n[15]=s[15]+t[15]*e,n}function ee(n,s){return n[0]===s[0]&&n[1]===s[1]&&n[2]===s[2]&&n[3]===s[3]&&n[4]===s[4]&&n[5]===s[5]&&n[6]===s[6]&&n[7]===s[7]&&n[8]===s[8]&&n[9]===s[9]&&n[10]===s[10]&&n[11]===s[11]&&n[12]===s[12]&&n[13]===s[13]&&n[14]===s[14]&&n[15]===s[15]}function ce(n,s){const t=n[0],e=n[1],c=n[2],r=n[3],i=n[4],o=n[5],l=n[6],f=n[7],h=n[8],d=n[9],a=n[10],M=n[11],p=n[12],w=n[13],m=n[14],y=n[15],_=s[0],g=s[1],$=s[2],z=s[3],v=s[4],q=s[5],L=s[6],x=s[7],S=s[8],P=s[9],E=s[10],F=s[11],b=s[12],C=s[13],Q=s[14],N=s[15];return Math.abs(t-_)<=A*Math.max(1,Math.abs(t),Math.abs(_))&&Math.abs(e-g)<=A*Math.max(1,Math.abs(e),Math.abs(g))&&Math.abs(c-$)<=A*Math.max(1,Math.abs(c),Math.abs($))&&Math.abs(r-z)<=A*Math.max(1,Math.abs(r),Math.abs(z))&&Math.abs(i-v)<=A*Math.max(1,Math.abs(i),Math.abs(v))&&Math.abs(o-q)<=A*Math.max(1,Math.abs(o),Math.abs(q))&&Math.abs(l-L)<=A*Math.max(1,Math.abs(l),Math.abs(L))&&Math.abs(f-x)<=A*Math.max(1,Math.abs(f),Math.abs(x))&&Math.abs(h-S)<=A*Math.max(1,Math.abs(h),Math.abs(S))&&Math.abs(d-P)<=A*Math.max(1,Math.abs(d),Math.abs(P))&&Math.abs(a-E)<=A*Math.max(1,Math.abs(a),Math.abs(E))&&Math.abs(M-F)<=A*Math.max(1,Math.abs(M),Math.abs(F))&&Math.abs(p-b)<=A*Math.max(1,Math.abs(p),Math.abs(b))&&Math.abs(w-C)<=A*Math.max(1,Math.abs(w),Math.abs(C))&&Math.abs(m-Q)<=A*Math.max(1,Math.abs(m),Math.abs(Q))&&Math.abs(y-N)<=A*Math.max(1,Math.abs(y),Math.abs(N))}const re=un,ie=ss,oe=Object.freeze(Object.defineProperty({__proto__:null,add:ne,adjoint:Lt,clone:vt,copy:gt,create:xt,determinant:qt,equals:ce,exactEquals:ee,frob:ut,fromQuat:Nt,fromQuat2:Ct,fromRotation:jt,fromRotationTranslation:ns,fromRotationTranslationScale:Wt,fromRotationTranslationScaleOrigin:Ut,fromScaling:Dt,fromTranslation:Tt,fromValues:$t,fromXRotation:Ot,fromYRotation:Rt,fromZRotation:It,frustum:Gt,getRotation:Yt,getScaling:Xt,getTranslation:Vt,identity:Kn,invert:bt,lookAt:Ht,mul:re,multiply:un,multiplyScalar:se,multiplyScalarAndAdd:te,ortho:Qt,perspective:Bt,perspectiveFromFieldOfView:Zt,rotate:Et,rotateX:Pt,rotateY:Ft,rotateZ:kt,scale:St,set:zt,str:Kt,sub:ie,subtract:ss,targetTo:Jt,translate:At,transpose:_t},Symbol.toStringTag,{value:"Module"}));function Pn(){const n=new D(3);return D!==Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function le(n){const s=new D(3);return s[0]=n[0],s[1]=n[1],s[2]=n[2],s}function ts(n){const s=n[0],t=n[1],e=n[2];return Math.sqrt(s*s+t*t+e*e)}function ln(n,s,t){const e=new D(3);return e[0]=n,e[1]=s,e[2]=t,e}function fe(n,s){return n[0]=s[0],n[1]=s[1],n[2]=s[2],n}function he(n,s,t,e){return n[0]=s,n[1]=t,n[2]=e,n}function ae(n,s,t){return n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2],n}function es(n,s,t){return n[0]=s[0]-t[0],n[1]=s[1]-t[1],n[2]=s[2]-t[2],n}function cs(n,s,t){return n[0]=s[0]*t[0],n[1]=s[1]*t[1],n[2]=s[2]*t[2],n}function rs(n,s,t){return n[0]=s[0]/t[0],n[1]=s[1]/t[1],n[2]=s[2]/t[2],n}function Me(n,s){return n[0]=Math.ceil(s[0]),n[1]=Math.ceil(s[1]),n[2]=Math.ceil(s[2]),n}function de(n,s){return n[0]=Math.floor(s[0]),n[1]=Math.floor(s[1]),n[2]=Math.floor(s[2]),n}function me(n,s,t){return n[0]=Math.min(s[0],t[0]),n[1]=Math.min(s[1],t[1]),n[2]=Math.min(s[2],t[2]),n}function pe(n,s,t){return n[0]=Math.max(s[0],t[0]),n[1]=Math.max(s[1],t[1]),n[2]=Math.max(s[2],t[2]),n}function we(n,s){return n[0]=Math.round(s[0]),n[1]=Math.round(s[1]),n[2]=Math.round(s[2]),n}function ye(n,s,t){return n[0]=s[0]*t,n[1]=s[1]*t,n[2]=s[2]*t,n}function xe(n,s,t,e){return n[0]=s[0]+t[0]*e,n[1]=s[1]+t[1]*e,n[2]=s[2]+t[2]*e,n}function is(n,s){const t=s[0]-n[0],e=s[1]-n[1],c=s[2]-n[2];return Math.sqrt(t*t+e*e+c*c)}function os(n,s){const t=s[0]-n[0],e=s[1]-n[1],c=s[2]-n[2];return t*t+e*e+c*c}function ls(n){const s=n[0],t=n[1],e=n[2];return s*s+t*t+e*e}function ve(n,s){return n[0]=-s[0],n[1]=-s[1],n[2]=-s[2],n}function ge(n,s){return n[0]=1/s[0],n[1]=1/s[1],n[2]=1/s[2],n}function gn(n,s){const t=s[0],e=s[1],c=s[2];let r=t*t+e*e+c*c;return r>0&&(r=1/Math.sqrt(r),n[0]=s[0]*r,n[1]=s[1]*r,n[2]=s[2]*r),n}function Fn(n,s){return n[0]*s[0]+n[1]*s[1]+n[2]*s[2]}function yn(n,s,t){const e=s[0],c=s[1],r=s[2],i=t[0],o=t[1],l=t[2];return n[0]=c*l-r*o,n[1]=r*i-e*l,n[2]=e*o-c*i,n}function $e(n,s,t,e){const c=s[0],r=s[1],i=s[2];return n[0]=c+e*(t[0]-c),n[1]=r+e*(t[1]-r),n[2]=i+e*(t[2]-i),n}function ze(n,s,t,e,c,r){const i=r*r,o=i*(2*r-3)+1,l=i*(r-2)+r,f=i*(r-1),h=i*(3-2*r);return n[0]=s[0]*o+t[0]*l+e[0]*f+c[0]*h,n[1]=s[1]*o+t[1]*l+e[1]*f+c[1]*h,n[2]=s[2]*o+t[2]*l+e[2]*f+c[2]*h,n}function _e(n,s,t,e,c,r){const i=1-r,o=i*i,l=r*r,f=o*i,h=3*r*o,d=3*l*i,a=l*r;return n[0]=s[0]*f+t[0]*h+e[0]*d+c[0]*a,n[1]=s[1]*f+t[1]*h+e[1]*d+c[1]*a,n[2]=s[2]*f+t[2]*h+e[2]*d+c[2]*a,n}function be(n,s){s=s||1;const t=on()*2*Math.PI,e=on()*2-1,c=Math.sqrt(1-e*e)*s;return n[0]=Math.cos(t)*c,n[1]=Math.sin(t)*c,n[2]=e*s,n}function Le(n,s,t){const e=s[0],c=s[1],r=s[2];let i=t[3]*e+t[7]*c+t[11]*r+t[15];return i=i||1,n[0]=(t[0]*e+t[4]*c+t[8]*r+t[12])/i,n[1]=(t[1]*e+t[5]*c+t[9]*r+t[13])/i,n[2]=(t[2]*e+t[6]*c+t[10]*r+t[14])/i,n}function qe(n,s,t){const e=s[0],c=s[1],r=s[2];return n[0]=e*t[0]+c*t[3]+r*t[6],n[1]=e*t[1]+c*t[4]+r*t[7],n[2]=e*t[2]+c*t[5]+r*t[8],n}function Ae(n,s,t){const e=t[0],c=t[1],r=t[2],i=t[3],o=s[0],l=s[1],f=s[2];let h=c*f-r*l,d=r*o-e*f,a=e*l-c*o,M=c*a-r*d,p=r*h-e*a,w=e*d-c*h;const m=i*2;return h*=m,d*=m,a*=m,M*=2,p*=2,w*=2,n[0]=o+h+M,n[1]=l+d+p,n[2]=f+a+w,n}function Se(n,s,t,e){const c=[],r=[];return c[0]=s[0]-t[0],c[1]=s[1]-t[1],c[2]=s[2]-t[2],r[0]=c[0],r[1]=c[1]*Math.cos(e)-c[2]*Math.sin(e),r[2]=c[1]*Math.sin(e)+c[2]*Math.cos(e),n[0]=r[0]+t[0],n[1]=r[1]+t[1],n[2]=r[2]+t[2],n}function Ee(n,s,t,e){const c=[],r=[];return c[0]=s[0]-t[0],c[1]=s[1]-t[1],c[2]=s[2]-t[2],r[0]=c[2]*Math.sin(e)+c[0]*Math.cos(e),r[1]=c[1],r[2]=c[2]*Math.cos(e)-c[0]*Math.sin(e),n[0]=r[0]+t[0],n[1]=r[1]+t[1],n[2]=r[2]+t[2],n}function Pe(n,s,t,e){const c=[],r=[];return c[0]=s[0]-t[0],c[1]=s[1]-t[1],c[2]=s[2]-t[2],r[0]=c[0]*Math.cos(e)-c[1]*Math.sin(e),r[1]=c[0]*Math.sin(e)+c[1]*Math.cos(e),r[2]=c[2],n[0]=r[0]+t[0],n[1]=r[1]+t[1],n[2]=r[2]+t[2],n}function Fe(n,s){const t=ln(n[0],n[1],n[2]),e=ln(s[0],s[1],s[2]);gn(t,t),gn(e,e);const c=Fn(t,e);return c>1?0:c<-1?Math.PI:Math.acos(c)}function ke(n){return`vec3(${n[0]}, ${n[1]}, ${n[2]})`}function Te(n,s){return n[0]===s[0]&&n[1]===s[1]&&n[2]===s[2]}function De(n,s){const t=n[0],e=n[1],c=n[2],r=s[0],i=s[1],o=s[2];return Math.abs(t-r)<=A*Math.max(1,Math.abs(t),Math.abs(r))&&Math.abs(e-i)<=A*Math.max(1,Math.abs(e),Math.abs(i))&&Math.abs(c-o)<=A*Math.max(1,Math.abs(c),Math.abs(o))}const je=es,Oe=cs,Re=rs,Ie=is,Ce=os,fs=ts,Ve=ls,Xe=(function(){const n=Pn();return function(s,t,e,c,r,i){let o,l;for(t||(t=3),e||(e=0),c?l=Math.min(c*t+e,s.length):l=s.length,o=e;o<l;o+=t)n[0]=s[o],n[1]=s[o+1],n[2]=s[o+2],r(n,n,i),s[o]=n[0],s[o+1]=n[1],s[o+2]=n[2];return s}})(),Ye=Object.freeze(Object.defineProperty({__proto__:null,add:ae,angle:Fe,bezier:_e,ceil:Me,clone:le,copy:fe,create:Pn,cross:yn,dist:Ie,distance:is,div:Re,divide:rs,dot:Fn,equals:De,exactEquals:Te,floor:de,forEach:Xe,fromValues:ln,hermite:ze,inverse:ge,len:fs,length:ts,lerp:$e,max:pe,min:me,mul:Oe,multiply:cs,negate:ve,normalize:gn,random:be,rotateX:Se,rotateY:Ee,rotateZ:Pe,round:we,scale:ye,scaleAndAdd:xe,set:he,sqrDist:Ce,sqrLen:Ve,squaredDistance:os,squaredLength:ls,str:ke,sub:je,subtract:es,transformMat3:qe,transformMat4:Le,transformQuat:Ae},Symbol.toStringTag,{value:"Module"}));function We(){const n=new D(4);return D!==Float32Array&&(n[0]=0,n[1]=0,n[2]=0,n[3]=0),n}function Ue(n){const s=new D(4);return s[0]=n[0],s[1]=n[1],s[2]=n[2],s[3]=n[3],s}function Ne(n,s,t,e){const c=new D(4);return c[0]=n,c[1]=s,c[2]=t,c[3]=e,c}function Ge(n,s){return n[0]=s[0],n[1]=s[1],n[2]=s[2],n[3]=s[3],n}function Be(n,s,t,e,c){return n[0]=s,n[1]=t,n[2]=e,n[3]=c,n}function Ze(n,s,t){return n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2],n[3]=s[3]+t[3],n}function Qe(n,s,t){return n[0]=s[0]*t,n[1]=s[1]*t,n[2]=s[2]*t,n[3]=s[3]*t,n}function He(n){const s=n[0],t=n[1],e=n[2],c=n[3];return Math.sqrt(s*s+t*t+e*e+c*c)}function Je(n){const s=n[0],t=n[1],e=n[2],c=n[3];return s*s+t*t+e*e+c*c}function Ke(n,s){const t=s[0],e=s[1],c=s[2],r=s[3];let i=t*t+e*e+c*c+r*r;return i>0&&(i=1/Math.sqrt(i),n[0]=t*i,n[1]=e*i,n[2]=c*i,n[3]=r*i),n}function ue(n,s){return n[0]*s[0]+n[1]*s[1]+n[2]*s[2]+n[3]*s[3]}function n1(n,s,t,e){const c=s[0],r=s[1],i=s[2],o=s[3];return n[0]=c+e*(t[0]-c),n[1]=r+e*(t[1]-r),n[2]=i+e*(t[2]-i),n[3]=o+e*(t[3]-o),n}function s1(n,s){return n[0]===s[0]&&n[1]===s[1]&&n[2]===s[2]&&n[3]===s[3]}function t1(n,s){const t=n[0],e=n[1],c=n[2],r=n[3],i=s[0],o=s[1],l=s[2],f=s[3];return Math.abs(t-i)<=A*Math.max(1,Math.abs(t),Math.abs(i))&&Math.abs(e-o)<=A*Math.max(1,Math.abs(e),Math.abs(o))&&Math.abs(c-l)<=A*Math.max(1,Math.abs(c),Math.abs(l))&&Math.abs(r-f)<=A*Math.max(1,Math.abs(r),Math.abs(f))}(function(){const n=We();return function(s,t,e,c,r,i){let o,l;for(t||(t=4),e||(e=0),c?l=Math.min(c*t+e,s.length):l=s.length,o=e;o<l;o+=t)n[0]=s[o],n[1]=s[o+1],n[2]=s[o+2],n[3]=s[o+3],r(n,n,i),s[o]=n[0],s[o+1]=n[1],s[o+2]=n[2],s[o+3]=n[3];return s}})();function qn(){const n=new D(4);return D!==Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function e1(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n}function hs(n,s,t){t=t*.5;const e=Math.sin(t);return n[0]=e*s[0],n[1]=e*s[1],n[2]=e*s[2],n[3]=Math.cos(t),n}function c1(n,s){const t=Math.acos(s[3])*2,e=Math.sin(t/2);return e>A?(n[0]=s[0]/e,n[1]=s[1]/e,n[2]=s[2]/e):(n[0]=1,n[1]=0,n[2]=0),t}function as(n,s,t){const e=s[0],c=s[1],r=s[2],i=s[3],o=t[0],l=t[1],f=t[2],h=t[3];return n[0]=e*h+i*o+c*f-r*l,n[1]=c*h+i*l+r*o-e*f,n[2]=r*h+i*f+e*l-c*o,n[3]=i*h-e*o-c*l-r*f,n}function r1(n,s,t){t*=.5;const e=s[0],c=s[1],r=s[2],i=s[3],o=Math.sin(t),l=Math.cos(t);return n[0]=e*l+i*o,n[1]=c*l+r*o,n[2]=r*l-c*o,n[3]=i*l-e*o,n}function i1(n,s,t){t*=.5;const e=s[0],c=s[1],r=s[2],i=s[3],o=Math.sin(t),l=Math.cos(t);return n[0]=e*l-r*o,n[1]=c*l+i*o,n[2]=r*l+e*o,n[3]=i*l-c*o,n}function o1(n,s,t){t*=.5;const e=s[0],c=s[1],r=s[2],i=s[3],o=Math.sin(t),l=Math.cos(t);return n[0]=e*l+c*o,n[1]=c*l-e*o,n[2]=r*l+i*o,n[3]=i*l-r*o,n}function l1(n,s){const t=s[0],e=s[1],c=s[2];return n[0]=t,n[1]=e,n[2]=c,n[3]=Math.sqrt(Math.abs(1-t*t-e*e-c*c)),n}function xn(n,s,t,e){const c=s[0],r=s[1],i=s[2],o=s[3];let l=t[0],f=t[1],h=t[2],d=t[3],a,M,p,w,m;return M=c*l+r*f+i*h+o*d,M<0&&(M=-M,l=-l,f=-f,h=-h,d=-d),1-M>A?(a=Math.acos(M),p=Math.sin(a),w=Math.sin((1-e)*a)/p,m=Math.sin(e*a)/p):(w=1-e,m=e),n[0]=w*c+m*l,n[1]=w*r+m*f,n[2]=w*i+m*h,n[3]=w*o+m*d,n}function f1(n){const s=on(),t=on(),e=on(),c=Math.sqrt(1-s),r=Math.sqrt(s);return n[0]=c*Math.sin(2*Math.PI*t),n[1]=c*Math.cos(2*Math.PI*t),n[2]=r*Math.sin(2*Math.PI*e),n[3]=r*Math.cos(2*Math.PI*e),n}function h1(n,s){const t=s[0],e=s[1],c=s[2],r=s[3],i=t*t+e*e+c*c+r*r,o=i?1/i:0;return n[0]=-t*o,n[1]=-e*o,n[2]=-c*o,n[3]=r*o,n}function a1(n,s){return n[0]=-s[0],n[1]=-s[1],n[2]=-s[2],n[3]=s[3],n}function Ms(n,s){const t=s[0]+s[4]+s[8];let e;if(t>0)e=Math.sqrt(t+1),n[3]=.5*e,e=.5/e,n[0]=(s[5]-s[7])*e,n[1]=(s[6]-s[2])*e,n[2]=(s[1]-s[3])*e;else{let c=0;s[4]>s[0]&&(c=1),s[8]>s[c*3+c]&&(c=2);const r=(c+1)%3,i=(c+2)%3;e=Math.sqrt(s[c*3+c]-s[r*3+r]-s[i*3+i]+1),n[c]=.5*e,e=.5/e,n[3]=(s[r*3+i]-s[i*3+r])*e,n[r]=(s[r*3+c]+s[c*3+r])*e,n[i]=(s[i*3+c]+s[c*3+i])*e}return n}function M1(n,s,t,e){const c=.5*Math.PI/180;s*=c,t*=c,e*=c;const r=Math.sin(s),i=Math.cos(s),o=Math.sin(t),l=Math.cos(t),f=Math.sin(e),h=Math.cos(e);return n[0]=r*l*h-i*o*f,n[1]=i*o*h+r*l*f,n[2]=i*l*f-r*o*h,n[3]=i*l*h+r*o*f,n}function d1(n){return`quat(${n[0]}, ${n[1]}, ${n[2]}, ${n[3]})`}const m1=Ue,p1=Ne,w1=Ge,y1=Be,x1=Ze,v1=as,g1=Qe,$1=ue,z1=n1,ds=He,_1=ds,ms=Je,b1=ms,kn=Ke,L1=s1,q1=t1,A1=(function(){const n=Pn(),s=ln(1,0,0),t=ln(0,1,0);return function(e,c,r){const i=Fn(c,r);return i<-.999999?(yn(n,s,c),fs(n)<1e-6&&yn(n,t,c),gn(n,n),hs(e,n,Math.PI),e):i>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(yn(n,c,r),e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=1+i,kn(e,e))}})(),S1=(function(){const n=qn(),s=qn();return function(t,e,c,r,i,o){return xn(n,e,i,o),xn(s,c,r,o),xn(t,n,s,2*o*(1-o)),t}})(),E1=(function(){const n=Qn();return function(s,t,e,c){return n[0]=e[0],n[3]=e[1],n[6]=e[2],n[1]=c[0],n[4]=c[1],n[7]=c[2],n[2]=-t[0],n[5]=-t[1],n[8]=-t[2],kn(s,Ms(s,n))}})(),P1=Object.freeze(Object.defineProperty({__proto__:null,add:x1,calculateW:l1,clone:m1,conjugate:a1,copy:w1,create:qn,dot:$1,equals:q1,exactEquals:L1,fromEuler:M1,fromMat3:Ms,fromValues:p1,getAxisAngle:c1,identity:e1,invert:h1,len:_1,length:ds,lerp:z1,mul:v1,multiply:as,normalize:kn,random:f1,rotateX:r1,rotateY:i1,rotateZ:o1,rotationTo:A1,scale:g1,set:y1,setAxes:E1,setAxisAngle:hs,slerp:xn,sqlerp:S1,sqrLen:b1,squaredLength:ms,str:d1},Symbol.toStringTag,{value:"Module"}));function F1(){const n=new D(2);return D!==Float32Array&&(n[0]=0,n[1]=0),n}(function(){const n=F1();return function(s,t,e,c,r,i){let o,l;for(t||(t=2),e||(e=0),c?l=Math.min(c*t+e,s.length):l=s.length,o=e;o<l;o+=t)n[0]=s[o],n[1]=s[o+1],r(n,n,i),s[o]=n[0],s[o+1]=n[1];return s}})();const tn=Ye,k1=yt,vn=oe,B=P1,R=new Float32Array(16),Z=new Float32Array(16);function ps(n,s,t){this.rotation=n,this.center=s,this.distance=t}const an=ps.prototype;an.view=function(n){return n||(n=vn.create()),Z[0]=Z[1]=0,Z[2]=-this.distance,vn.fromRotationTranslation(n,B.conjugate(R,this.rotation),Z),vn.translate(n,n,tn.negate(R,this.center)),n};an.lookAt=function(n,s,t){vn.lookAt(R,n,s,t),k1.fromMat4(R,R),B.fromMat3(this.rotation,R),tn.copy(this.center,s),this.distance=tn.distance(n,s)};an.pan=function(n){const s=this.distance;R[0]=-s*(n[0]||0),R[1]=s*(n[1]||0),R[2]=s*(n[2]||0),tn.transformQuat(R,R,this.rotation),tn.add(this.center,this.center,R)};an.zoom=function(n){this.distance+=n,this.distance<0&&(this.distance=0)};function Cn(n,s){const t=s[0],e=s[1];let c=t*t+e*e;c>1&&(c=1),n[0]=-s[0],n[1]=s[1],n[2]=s[2]||Math.sqrt(1-c),n[3]=0}an.rotate=function(n,s){Cn(R,n),Cn(Z,s),B.invert(Z,Z),B.multiply(R,R,Z),!(B.length(R)<1e-6)&&(B.multiply(this.rotation,this.rotation,R),B.normalize(this.rotation,this.rotation))};function T1(n,s,t){n=n||[0,0,-1],s=s||[0,0,0],t=t||[0,1,0];const e=new ps(B.create(),tn.create(),1);return e.lookAt(n,s,t),e}const Tn=typeof window<"u"?window.navigator.userAgent:"",zn=/OS X/.test(Tn),ws=/Opera/.test(Tn),D1=!/like Gecko/.test(Tn)&&!ws;let k;const U={0:zn?"<menu>":"<UNK>",1:"<mouse 1>",2:"<mouse 2>",3:"<break>",4:"<mouse 3>",5:"<mouse 4>",6:"<mouse 5>",8:"<backspace>",9:"<tab>",12:"<clear>",13:"<enter>",16:"<shift>",17:"<control>",18:"<alt>",19:"<pause>",20:"<caps-lock>",21:"<ime-hangul>",23:"<ime-junja>",24:"<ime-final>",25:"<ime-kanji>",27:"<escape>",28:"<ime-convert>",29:"<ime-nonconvert>",30:"<ime-accept>",31:"<ime-mode-change>",32:"<space>",33:"<page-up>",34:"<page-down>",35:"<end>",36:"<home>",37:"<left>",38:"<up>",39:"<right>",40:"<down>",41:"<select>",42:"<print>",43:"<execute>",44:"<snapshot>",45:"<insert>",46:"<delete>",47:"<help>",91:"<meta>",92:"<meta>",93:zn?"<meta>":"<menu>",95:"<sleep>",106:"<num-*>",107:"<num-+>",108:"<num-enter>",109:"<num-->",110:"<num-.>",111:"<num-/>",144:"<num-lock>",145:"<scroll-lock>",160:"<shift-left>",161:"<shift-right>",162:"<control-left>",163:"<control-right>",164:"<alt-left>",165:"<alt-right>",166:"<browser-back>",167:"<browser-forward>",168:"<browser-refresh>",169:"<browser-stop>",170:"<browser-search>",171:"<browser-favorites>",172:"<browser-home>",173:zn&&D1?"-":"<volume-mute>",174:"<volume-down>",175:"<volume-up>",176:"<next-track>",177:"<prev-track>",178:"<stop>",179:"<play-pause>",180:"<launch-mail>",181:"<launch-media-select>",182:"<launch-app 1>",183:"<launch-app 2>",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",223:"<meta>",224:"<meta>",226:"<alt-gr>",229:"<ime-process>",231:ws?"`":"<unicode>",246:"<attention>",247:"<crsel>",248:"<exsel>",249:"<erase-eof>",250:"<play>",251:"<zoom>",252:"<no-name>",253:"<pa-1>",254:"<clear>"};for(k=58;k<65;++k)U[k]=String.fromCharCode(k);for(k=48;k<58;++k)U[k]=`${k-48}`;for(k=65;k<91;++k)U[k]=String.fromCharCode(k);for(k=96;k<106;++k)U[k]=`<num-${k-96}>`;for(k=112;k<136;++k)U[k]=`F${k-111}`;const j1=Object.keys(U),fn={};ys();window.addEventListener("keydown",R1,!1);window.addEventListener("keyup",O1,!1);window.addEventListener("blur",ys,!1);function _n(n){return n?fn[n]:fn}function ys(){j1.forEach(function(n){fn[U[n]]=!1})}function O1(n){fn[U[n.keyCode]]=!1}function R1(n){fn[U[n.keyCode]]=!0}function j(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}j.EventEmitter=j;j.prototype._events=void 0;j.prototype._maxListeners=void 0;j.defaultMaxListeners=10;j.prototype.setMaxListeners=function(n){if(!I1(n)||n<0||isNaN(n))throw TypeError("n must be a positive number");return this._maxListeners=n,this};j.prototype.emit=function(n){let s,t,e,c,r;if(this._events||(this._events={}),n==="error"&&(!this._events.error||hn(this._events.error)&&!this._events.error.length)){if(s=arguments[1],s instanceof Error)throw s;{const o=new Error(`Uncaught, unspecified "error" event. (${s})`);throw o.context=s,o}}const i=this._events[n];if(xs(i))return!1;if(W(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:e=Array.prototype.slice.call(arguments,1),i.apply(this,e)}else if(hn(i))for(e=Array.prototype.slice.call(arguments,1),r=i.slice(),t=r.length,c=0;c<t;c++)r[c].apply(this,e);return!0};j.prototype.addListener=function(n,s){let t;if(!W(s))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",n,W(s.listener)?s.listener:s),this._events[n]?hn(this._events[n])?this._events[n].push(s):this._events[n]=[this._events[n],s]:this._events[n]=s,hn(this._events[n])&&!this._events[n].warned&&(xs(this._maxListeners)?t=j.defaultMaxListeners:t=this._maxListeners,t&&t>0&&this._events[n].length>t&&(this._events[n].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[n].length),typeof console.trace=="function"&&console.trace())),this};j.prototype.on=j.prototype.addListener;j.prototype.once=function(n,s){if(!W(s))throw TypeError("listener must be a function");let t=!1;function e(){this.removeListener(n,e),t||(t=!0,s.apply(this,arguments))}return e.listener=s,this.on(n,e),this};j.prototype.removeListener=function(n,s){let t,e;if(!W(s))throw TypeError("listener must be a function");if(!this._events||!this._events[n])return this;const c=this._events[n],r=c.length;if(t=-1,c===s||W(c.listener)&&c.listener===s)delete this._events[n],this._events.removeListener&&this.emit("removeListener",n,s);else if(hn(c)){for(e=r;e-- >0;)if(c[e]===s||c[e].listener&&c[e].listener===s){t=e;break}if(t<0)return this;c.length===1?(c.length=0,delete this._events[n]):c.splice(t,1),this._events.removeListener&&this.emit("removeListener",n,s)}return this};j.prototype.removeAllListeners=function(n){let s;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[n]&&delete this._events[n],this;if(arguments.length===0){for(s in this._events)s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events={},this}const t=this._events[n];if(W(t))this.removeListener(n,t);else if(t)for(;t.length;)this.removeListener(n,t[t.length-1]);return delete this._events[n],this};j.prototype.listeners=function(n){let s;return!this._events||!this._events[n]?s=[]:W(this._events[n])?s=[this._events[n]]:s=this._events[n].slice(),s};j.prototype.listenerCount=function(n){if(this._events){const s=this._events[n];if(W(s))return 1;if(s)return s.length}return 0};j.listenerCount=function(n,s){return n.listenerCount(s)};function W(n){return typeof n=="function"}function I1(n){return typeof n=="number"}function hn(n){return typeof n=="object"&&n!==null}function xs(n){return n===void 0}function C1(n,s){const t=new j;if(t[0]=0,t[1]=0,t.prev=[0,0],t.flush=c,t.dispose=r,typeof window>"u")return t;s=s||n||window,n=n||document.body;const e=n===document.body||n===window?function(i){t.prev[0]=t[0],t.prev[1]=t[1],t[0]=i.clientX,t[1]=i.clientY,t.emit("move",i)}:function(i){t.prev[0]=t[0],t.prev[1]=t[1];const o=n.getBoundingClientRect();t[0]=i.clientX-o.left,t[1]=i.clientY-o.top,t.emit("move",i)};return s.addEventListener("mousemove",e,!1),t;function c(){t.prev[0]=t[0],t.prev[1]=t[1]}function r(){t.removeAllListeners("move"),s.removeEventListener("mousemove",e)}}const Vn=["left","middle","right"];function V1(n,s){const t=new j;return t.left=!1,t.right=!1,t.middle=!1,t.dispose=i,typeof window<"u"&&(n=n||window,n.addEventListener("mousedown",e,!1),window.addEventListener("mouseup",c,!1),s&&n.addEventListener("contextmenu",r,!1)),t;function e(o){if(t.right=!1,t[Vn[o.button]]=!0,t.emit("down",o),!!s){if(!o.preventDefault)return!1;o.preventDefault(),o.stopPropagation()}}function c(o){t.right=!1,t[Vn[o.button]]=!1,t.emit("up",o),s&&o.preventDefault&&(o.preventDefault(),o.stopPropagation())}function r(o){return o.preventDefault&&o.preventDefault()&&!1}function i(){t.left=!1,t.right=!1,t.middle=!1,n&&(n.removeEventListener("contextmenu",r,!1),n.removeEventListener("mousedown",e,!1),window.removeEventListener("mouseup",c,!1))}}let vs="",An;window.addEventListener?An="addEventListener":(An="attachEvent",vs="on");const $n="onwheel"in document.createElement("div")?"wheel":document.onmousewheel!==void 0?"mousewheel":"DOMMouseScroll";function X1(n,s,t){Xn(n,$n,s),$n==="DOMMouseScroll"&&Xn(n,"MozMousePixelScroll",s)}function Xn(n,s,t,e){n[An](vs+s,$n==="wheel"?t:function(c){!c&&(c=window.event);const r={deltaY:0,originalEvent:c,target:c.target||c.srcElement,type:"wheel",deltaMode:c.type==="MozMousePixelScroll"?0:1,deltaX:0,delatZ:0,preventDefault(){c.preventDefault?c.preventDefault():c.returnValue=!1}};return $n==="mousewheel"?(r.deltaY=-1/40*c.wheelDelta,c.wheelDeltaX&&(r.deltaX=-1/40*c.wheelDeltaX)):r.deltaY=c.detail,t(r)},!1)}function Y1(n,s){const t=new j;if(t.flush=e,e(),typeof window>"u")return t;return n=n||window,X1(n,c),t;function e(){t[0]=t[1]=t[2]=0}function c(r){const i=r.deltaMode===1?12:1;t[0]+=i*(r.deltaX||0),t[1]+=i*(r.deltaY||0),t[2]+=i*(r.deltaZ||0),t.emit("scroll",t),s&&r.preventDefault&&(r.preventDefault(),r.stopPropagation&&r.stopPropagation())}}const Yn=1;function W1(n,s){s=s||{},s.pan=s.pan!==!1,s.scale=s.scale!==!1,s.rotate=s.rotate!==!1;const t=Y1(n,s.scale),e=V1(n,s.rotate),c=C1(n),r=T1([0,10,30],[0,0,0],[0,1,0]);return r.tick=i,r;function i(){const o=_n("<control>")||_n("<alt>"),l=_n("<shift>"),f=n.height,h=n.width;if(s.rotate&&e.left&&!o&&!l&&r.rotate([c[0]/h-.5,c[1]/f-.5],[c.prev[0]/h-.5,c.prev[1]/f-.5]),(s.pan&&e.right||e.left&&o&&!l)&&r.pan([Yn*(c[0]-c.prev[0])/h,Yn*(c[1]-c.prev[1])/f]),s.scale&&t[1]&&(r.distance*=Math.exp(t[1]/f)),s.scale&&(e.middle||e.left&&!o&&l)){const d=c.y-c.prevY;if(!d)return;r.distance*=Math.exp(d/f)}t.flush(),c.flush()}}const U1=Sn("position",sn()),N1=Sn("normal",sn()),G1=Sn("uv",Un()),B1=En("projection",Zn()),Z1=En("view",Zn()),Q1=js(En("texture")),gs=Nn("vUv",Un()),$s=Nn("vNormal",sn()),bn=As("main",()=>{Gn("mediump","float"),gs.assign(G1),$s.assign(N1),Ss.assign(B1.multiply(Z1).multiply(Bn(U1,1)))}),Wn=Es("main",()=>{Gn("mediump","float");const n=u("tex",Os(Q1,gs).xyz),s=u("lightDir",Vs(sn(.4,.9,.3))),t=u("n",$s);Rs(Fs.equals(!1),()=>{t.assign(Ps(-1).multiply(t))});const e=u("dotProduct",Cs(t,s)),c=u("absDotProduct",Xs(e,0,1)),r=u("ambient",sn(.3).multiply(n)),i=u("diffuse",sn(.7).multiply(n).multiply(c));Is(Bn(r.add(i),1))});function H1(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function J1(n,s,t,e,c){const r=1/Math.tan(s/2),i=1/(e-c);return n[0]=r/t,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=r,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=(c+e)*i,n[11]=-1,n[12]=0,n[13]=0,n[14]=2*c*e*i,n[15]=0,n}function K1(n,s,t,e){let c,r,i,o,l,f,h,d,a,M;const p=s[0],w=s[1],m=s[2],y=e[0],_=e[1],g=e[2],$=t[0],z=t[1],v=t[2];return Math.abs(p-$)<1e-6&&Math.abs(w-z)<1e-6&&Math.abs(m-v)<1e-6?H1(n):(h=p-$,d=w-z,a=m-v,M=1/Math.sqrt(h*h+d*d+a*a),h*=M,d*=M,a*=M,c=_*a-g*d,r=g*h-y*a,i=y*d-_*h,M=Math.sqrt(c*c+r*r+i*i),M?(M=1/M,c*=M,r*=M,i*=M):(c=0,r=0,i=0),o=d*i-a*r,l=a*c-h*i,f=h*r-d*c,M=Math.sqrt(o*o+l*l+f*f),M?(M=1/M,o*=M,l*=M,f*=M):(o=0,l=0,f=0),n[0]=c,n[1]=o,n[2]=h,n[3]=0,n[4]=r,n[5]=l,n[6]=d,n[7]=0,n[8]=i,n[9]=f,n[10]=a,n[11]=0,n[12]=-(c*p+r*w+i*m),n[13]=-(o*p+l*w+f*m),n[14]=-(h*p+d*w+a*m),n[15]=1,n)}function u1(){const n=new Float32Array(3);return n[0]=0,n[1]=0,n[2]=0,n}function mn(n,s,t){return n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2],n}function pn(n,s,t){return n[0]=s[0]-t[0],n[1]=s[1]-t[1],n[2]=s[2]-t[2],n}function nc(n,s,t){return n[0]=s[0]*t,n[1]=s[1]*t,n[2]=s[2]*t,n}function wn(n,s,t,e){return n[0]=s[0]+t[0]*e,n[1]=s[1]+t[1]*e,n[2]=s[2]+t[2]*e,n}function sc(n,s){const t=s[0]-n[0],e=s[1]-n[1],c=s[2]-n[2];return Math.sqrt(t*t+e*e+c*c)}function tc(n){const s=n[0],t=n[1],e=n[2];return Math.sqrt(s*s+t*t+e*e)}function Ln(n,s){const t=s[0],e=s[1],c=s[2];let r=t*t+e*e+c*c;return r>0&&(r=1/Math.sqrt(r),n[0]=s[0]*r,n[1]=s[1]*r,n[2]=s[2]*r),n}function ec(n,s,t){const e=s[0],c=s[1],r=s[2],i=t[0],o=t[1],l=t[2];return n[0]=c*l-r*o,n[1]=r*i-e*l,n[2]=e*o-c*i,n}u1();(async()=>{const n=window.devicePixelRatio||1,s=document.getElementById("webgpu");s.width=s.clientWidth*n,s.height=s.clientHeight*n;const t=await new Ts({canvasId:"webgpu"}).init(),e=document.getElementById("webgl");e.width=e.clientWidth*n,e.height=e.clientHeight*n;const c=new ks({canvasId:"webgl",webGLcontextId:"webgl2"}),r=bn.toGLSL(),i=Wn.toGLSL(),o=bn.toWGSL(),l=Wn.toWGSL(bn),f=W1(e);f.view(K1([],[0,3,30],[0,0,-5.5],[0,1,0])),f.rotate([0,0],[3.14*.15,0]);const h=[],d=[],a=[],M=[],p=[],w=[];class m{constructor(O,T){this.i0=O,this.i1=T,this.restLength=sc(a[O],a[T])}}const y=5.5,_=-y,g=Number(y),$=-y,z=Number(y),v=20;let q,L;for(q=0;q<=v;++q){const I=q/v*(z-$)+$,O=q/v;for(L=0;L<=v;++L){const T=L/v*(g-_)+_,Rn=L/v;a.push([T,0,I]),M.push([T,0,I]),h.push([Rn,O])}}let x,S,P,E,F;for(x=0;x<a.length;++x)p.push([0,0,0]);for(q=0;q<=v-1;++q)for(L=0;L<=v-1;++L)x=q*(v+1)+L,S=x+0,P=x+1,E=x+(v+1)+0,F=x+(v+1)+1,d.push([F,P,S]),d.push([S,E,F]);for(q=0;q<=v;++q)for(L=0;L<=v;++L)x=q*(v+1)+L,S=x+0,P=x+1,E=x+(v+1)+0,F=x+(v+1)+1,L<v&&w.push(new m(S,P)),q<v&&w.push(new m(S,E)),L<v&&q<v&&w.push(new m(S,F));const b=a.reduce((I,O)=>(O.forEach(T=>{I.push(T)}),I),[]),C=h.reduce((I,O)=>(O.forEach(T=>{I.push(T)}),I),[]),Q=p.reduce((I,O)=>(O.forEach(T=>{I.push(T)}),I),[]),N=d.reduce((I,O)=>(O.forEach(T=>{I.push(T)}),I),[]);let H=0,Mn=1,zs=1,Dn=0;const nn={vertices:{position:{data:new Float32Array(b),format:"float32x3"},normal:{data:new Float32Array(Q),format:"float32x3"},uv:{data:new Float32Array(C),format:"float32x2"}},indices:new Uint16Array(N),draw:{__type__:"DrawIndexed",indexCount:N.length},bindingResources:{},pipeline:{vertex:{glsl:r,wgsl:o},fragment:{glsl:i,wgsl:l,targets:[{blend:{}}]},depthStencil:{}}},jn={commandEncoders:[{passEncoders:[{descriptor:{colorAttachments:[{clearValue:[0,0,0,1]}]},renderPassObjects:[nn]}]}]};function On(){let O=[],T=[];const bs=[0,-4,0],cn=[Math.sin(H/2),Math.cos(H/3),Math.sin(H/1)];for(Ln(cn,cn),nc(cn,cn,20.6),x=0;x<a.length;++x)pn(O,a[x],M[x]),O=[O[0],O[1],O[2]],T=[a[x][0],a[x][1],a[x][2]],mn(T,T,O),wn(T,T,bs,.017*.017),wn(T,T,cn,.017*.017),M[x]=[a[x][0],a[x][1],a[x][2]],a[x]=[T[0],T[1],T[2]];const dn=[];let J,K;for(x=0;x<15;++x)for(let V=0;V<w.length;V++){const X=w[V];J=a[X.i0],K=a[X.i1],pn(dn,K,J);const G=tc(dn),Y=(G-X.restLength)/G;wn(J,J,dn,.5*Y),wn(K,K,dn,-.5*Y)}for(x=0;x<=v;++x)a[x]=[M[x][0],M[x][1],M[x][2]];for(x=0;x<p.length;x++)p[x]=[0,0,0];for(x=0;x<d.length;x++){S=d[x][0],P=d[x][1],E=d[x][2];const V=a[S],X=a[P],G=a[E];J=[0,0,0],pn(J,V,X),K=[0,0,0],pn(K,V,G);const Y=[0,0,0];ec(Y,J,K),Ln(Y,Y),mn(p[S],p[S],Y),mn(p[P],p[P],Y),mn(p[E],p[E],Y)}for(x=0;x<p.length;x++)Ln(p[x],p[x]);const Ls=a.reduce((V,X)=>(X.forEach(G=>{V.push(G)}),V),[]),qs=p.reduce((V,X)=>(X.forEach(G=>{V.push(G)}),V),[]);rn(In.getBuffer(nn.vertices.position.data.buffer)).writeBuffers=[{data:new Float32Array(Ls)}],rn(In.getBuffer(nn.vertices.normal.data.buffer)).writeBuffers=[{data:new Float32Array(qs)}],H++,f.tick(),rn(nn.bindingResources).view={value:f.view()},rn(nn.bindingResources).projection={value:J1([],Math.PI/4,Mn/zs,.01,1e3)},t.submit(jn),c.submit(jn),Dn===0&&(Dn++,Ds(c,t,e,s,0)),requestAnimationFrame(On)}const en=new Image;en.src="./assets/cloth.png",await en.decode();const _s={texture:{descriptor:{size:[en.width,en.height],generateMipmap:!0},sources:[{image:en}]},sampler:{minFilter:"linear",mipmapFilter:"linear",addressModeU:"repeat",addressModeV:"repeat"}};rn(nn.bindingResources).texture=_s,On()})();
